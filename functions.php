<?phpif (!isset($content_width)) $content_width = 770;if ( ! function_exists( 'powergenics_setup' ) ) :function powergenics_setup() {	register_nav_menus(        array(            'primary-menu'    => __( 'Primary Menu', 'powergenics' ),            'secondary-menu'    => __( 'Secondary Menu', 'powergenics' )        )    );	add_theme_support( 'automatic-feed-links' );	add_theme_support( 'title-tag' );	add_theme_support( 'post-thumbnails' ); 	add_theme_support( 'html5', array( 'comment-list', 'comment-form', 'search-form', 'gallery', 'caption' ) );	add_filter('widget_text', 'do_shortcode');		}endif;add_action( 'after_setup_theme', 'powergenics_setup' );if ( ! file_exists( get_template_directory() . '/includes/class-wp-bootstrap-navwalker.php' ) ) {	// file does not exist... return an error.	return new WP_Error( 'class-wp-bootstrap-navwalker-missing', __( 'It appears the class-wp-bootstrap-navwalker.php file may be missing.', 'wp-bootstrap-navwalker' ) );} else {	// file exists... require it.	require_once get_template_directory() . '/includes/class-wp-bootstrap-navwalker.php';}// Widgetsfunction powergenics_widgets_init() {	register_sidebar( array(		'name'          => 'Sidebar', 		'id'            => 'sidebar-1',		'description'   => 'Add sidebar widgets here.',		'before_widget' => '<div id="%1$s" class="widget %2$s">',		'after_widget'  => '</div>',		'before_title'  => '<h4 class="widget-title">',		'after_title'   => '</h4>',	) );	register_sidebar(array(		'name'	=> 'Slideshow',		'id'    => 'slideshow-1',		'description' => 'Add home page slideshow widgets here.',		'before_widget' => '<div id="%1$s" class="widget %2$s">',		'after_widget'  => '</div>',		'before_title'  => '',		'after_title'   => '',	) );	register_sidebar(array(		'name'	=> 'Store',		'id'    => 'store-1', 		'description' => 'Add widgets to a left sidebar on WooCommerce Pages.',		'before_widget' => '<div id="%1$s" class="widget mb-3 pb-3 border-bottom %2$s">',		'after_widget'  => '</div>',		'before_title'  => '<h4 class="widget-title text-secondary">',		'after_title'   => '</h4>',	) );		register_sidebar(array(		'name'	=> 'Footer Top',		'id'    => 'footer-1',		'description' => 'Add widgets to the footer of every page.',		'before_widget' => '<div id="%1$s" class="widget %2$s">',		'after_widget'  => '</div>',		'before_title'  => '',		'after_title'   => '',	) );    register_sidebar( array(		'name'          => 'Footer Left', 		'id'            => 'footer-left',		'description'   => 'Add widgets to the left side of the purple footer on every page.',		'before_widget' => '<div id="%1$s" class="widget %2$s">',		'after_widget'  => '</div>',		'before_title'  => '<h3 class="widget-title text-white">',		'after_title'   => '</h3>',	) );	register_sidebar( array(		'name'          => 'Footer Right', 		'id'            => 'footer-right',		'description'   => 'Add widgets to the  right side of the purple footer on every page.',		'before_widget' => '<div id="%1$s" class="widget %2$s">',		'after_widget'  => '</div>',		'before_title'  => '<h3 class="widget-title text-white">',		'after_title'   => '</h3>',	) );}add_action( 'widgets_init', 'powergenics_widgets_init' );add_filter('next_posts_link_attributes', 'posts_link_attributes');add_filter('previous_posts_link_attributes', 'posts_link_attributes');function posts_link_attributes() {    return 'class="btn btn-sm btn-secondary"';}// Load CSS and JS filesfunction powergenics_scripts() {	wp_register_style('google-font', 'https://fonts.googleapis.com/css?family=Raleway:300,400,600,700','','','all');	wp_register_style('bootstrap-css' , get_template_directory_uri() . '/stylesheets/screen.css','','', 'all');	wp_register_style('powergenics-style' , get_template_directory_uri() . '/style.css','','', 'all');		wp_register_script( 'bs-popper', get_template_directory_uri() . '/js/popper.min.js', 'jquery', '', true );	wp_register_script( 'bootstrap-js', get_template_directory_uri() . '/js/bootstrap.min.js', 'jquery', '', true );		wp_enqueue_script(array('jquery','bs-popper','bootstrap-js'));	wp_enqueue_style( array('google-font','bootstrap-css','powergenics-style'));	 }add_action( 'wp_enqueue_scripts', 'powergenics_scripts' ); // Gravity Forms // Gravity Formsadd_filter("gform_pre_submission_3", "populate_hidden_email");function populate_hidden_email($form){		$_POST['input_11'] = $_POST['input_40'];		}// Get a Quote autocomplete// Auto fill part number dropdown with product titles. Input field must have class "populate posts"add_filter( 'gform_pre_render', 'populate_posts' );add_filter( 'gform_pre_validation', 'populate_posts' );add_filter( 'gform_pre_submission_filter', 'populate_posts' );add_filter( 'gform_admin_pre_render', 'populate_posts' );function populate_posts( $form ) {     foreach ( $form['fields'] as &$field ) {         if ( $field->type != 'select' || strpos( $field->cssClass, 'populate-posts' ) === false ) {            continue;        }         // you can add additional parameters here to alter the posts that are retrieved        // more info: http://codex.wordpress.org/Template_Tags/get_posts        $posts = get_posts( 'post_type=product&numberposts=-1&post_status=publish' );         $choices = array();         foreach ( $posts as $post ) {            $choices[] = array( 'text' => $post->post_title, 'value' => $post->post_title );        }         // update 'Select a Post' to whatever you'd like the instructive option to be        $field->placeholder = 'Select a Part Number';        $field->choices = $choices;     }     return $form;}// WooCommerce// WooCommerce// WooCommerce Theme Supportfunction mytheme_add_woocommerce_support() {	add_theme_support( 'woocommerce' );}add_action( 'after_setup_theme', 'mytheme_add_woocommerce_support' );remove_action( 'woocommerce_before_main_content', 'woocommerce_output_content_wrapper', 10);remove_action( 'woocommerce_after_main_content', 'woocommerce_output_content_wrapper_end', 10);add_action('woocommerce_before_main_content', 'my_theme_wrapper_start', 10);add_action('woocommerce_after_main_content', 'my_theme_wrapper_end', 10);function my_theme_wrapper_start() {	echo '<section class="container">';		echo '<div class="row">';			echo get_sidebar();			echo '<div class="col order-1 order-md-2" id="main">';}function my_theme_wrapper_end() {  			echo '</div>'; // #main	  	echo '</div>'; // row	echo '</section>'; // container}/** * Change the placeholder image */add_filter('woocommerce_placeholder_img_src', 'custom_woocommerce_placeholder_img_src');function custom_woocommerce_placeholder_img_src( $src ) {	$upload_dir = wp_upload_dir();	$uploads = untrailingslashit( $upload_dir['baseurl'] );	// replace with path to your image	$src = $uploads . '/2018/06/powergenics-default-image.png';	 	return $src;}/** * Rename "home" in breadcrumb */add_filter( 'woocommerce_breadcrumb_defaults', 'wcc_change_breadcrumb_home_text' );function wcc_change_breadcrumb_home_text( $defaults ) {    // Change the breadcrumb home text from 'Home' to 'Apartment'	$defaults['home'] = 'Powergenics';	return $defaults;}// List WooCommerce Categories on home page under search boxadd_action('powergenics_product_cat','echo_powergenics_product_cat');function echo_powergenics_product_cat() {	$orderby = 'name';	$order = 'asc';	$hide_empty = true ;	$cat_args = array(		'orderby'    => $orderby,		'order'      => $order,		'hide_empty' => $hide_empty,	);	$product_categories = get_terms( 'product_cat', $cat_args );	if( !empty($product_categories) ){		echo '<h5 class="text-secondary mb-0 mt-3">Product Categories</h5>';		echo '<ul class="nav mb-3 justify-content-between">';				foreach ($product_categories as $key => $category) {			echo '	<li class="nav-item">';			echo '<a class="nav-link" title="'.get_the_title($category).'" href="'.get_term_link($category).'" >';			echo $category->name;			echo '</a>';			echo '</li>';		}		echo '</ul>	';	}}/** * Hide category product count in product archives */add_filter( 'woocommerce_subcategory_count_html', '__return_false' );// Get a quote Button/** * Change text strings * * @link http://codex.wordpress.org/Plugin_API/Filter_Reference/gettext */// CHANGE RELATED PRODUCTS TEXTfunction my_text_strings( $translated_text, $text, $domain ) {    switch ( $translated_text ) {        case 'Related products' :            $translated_text = __( 'Customers who viewed this item also viewed...', 'woocommerce' );            break;    }    return $translated_text;}add_filter( 'gettext', 'my_text_strings', 20, 3 );add_action('woocommerce_product_meta_start', 'powergenics_request_quote_btn');function powergenics_request_quote_btn() {  echo '<a href="/quote?part=' . get_the_title() . '" title="Request a Quote" class="btn btn-primary mb-3" target="_self">Request a Quote</a>';  echo '<div class="w-100 d-block"></div>';} add_action('woocommerce_product_meta_end','powergenics_warranty_badge');function powergenics_warranty_badge() {	 echo '<div class="w-100 d-block"></div>';	  echo '<a href="' . get_bloginfo('url') . '#warranty" title="View Warranty Information"><img src="/wp-content/uploads/2017/02/powergenics-warranty-badge.png" width="100" height="100" class="img-fluid warranty-logo my-3"></a>';  echo '<div class="w-100 d-block"></div>';}// Remove H2 Description from tabadd_filter( 'woocommerce_product_description_heading', 'remove_product_description_heading' );function remove_product_description_heading() {return '';}